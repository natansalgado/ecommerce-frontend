<app-header></app-header>
<div *ngIf="products.length < 1">
  <h1 class="mt-2 px-4">Erro ao buscar produtos no banco de dados</h1>
</div>

<div *ngIf="products.length >= 1">
  <h1 class="mt-2 px-4">Produtos</h1>
  <div class="row mt-3 mx-3 justify-content-center">
    <button
      [routerLink]="['/product', product.id]"
      *ngFor="let product of products"
      class="border p-0 text-left d-flex flex-column align-items-start m-2"
      style="max-width: 220px; height: 380px"
    >
      <img
        src="{{ product.image_urls[0] }}"
        class="img-fluid text-center w-100 p-1"
        alt="{{ product.title }}"
        style="height: 55%;"
      />
      <div class="px-2 text-start">
        <h5 style="height: 48px">{{ product.title }}</h5>
        <p class="mb-1">R$ {{ product.price | number : "1.2-2" }}</p>
        <div *ngIf="product.ratings > 0" class="rating d-flex">
          <span
            *ngFor="let star of [1, 2, 3, 4, 5]"
            [ngClass]="{
              filled: star <= calcRoundedStars(product.stars, product.ratings)
            }"
          >
            <i class="fa fa-star"></i>
          </span>
          <p class="mx-2 mb-1">
            {{ calcStars(product.stars, product.ratings) | number : "1.1-1" }}
          </p>
        </div>
        <p *ngIf="product.ratings <= 0" class="mb-1">sem avaliações</p>
        <p class="mb-1">
          <span class="text-nowrap"> {{ product.ratings }} avaliações </span>
          -
          <span class="text-nowrap"> {{ product.sold }} vendidos</span>
        </p>
        <a [routerLink]="['/store', product.store_id]">{{
          product.store.name
        }}</a>
      </div>
    </button>
  </div>
</div>
